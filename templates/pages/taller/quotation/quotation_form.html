{% load i18n %}
{% load static %}
<link href="{% static "themes/global/bootstrap-datepicker/dist/css/bootstrap-datepicker.min.css" %}" rel="stylesheet">
<script src="{% static "themes/global/bootstrap-datepicker/dist/js/bootstrap-datepicker.min.js" %}"></script>
<script src="{% static "themes/global/bootstrap-datepicker/dist/locales/bootstrap-datepicker.es.min.js" %}"></script>
<script src="{% static "themes/global/bootstrap3-typeahead/bootstrap3-typeahead.min.js" %}"></script>
<link href="{% static "themes/global/bootstrap-touchspin/dist/jquery.bootstrap-touchspin.min.css" %}" rel="stylesheet">
<script src="{% static "themes/global/bootstrap-touchspin/dist/jquery.bootstrap-touchspin.min.js" %}"></script>
<script>
     (function($) {
        $('#id_quotation_current_date').datepicker({autoclose: true, format: 'yyyy-mm-dd', language:'es'});
        $(".vertical-spin").TouchSpin({
                verticalbuttons: true,
                verticalupclass: 'ti-plus',
                verticaldownclass: 'ti-minus'
            });
            var vspinTrue = jQuery(".vertical-spin").TouchSpin({
                verticalbuttons: true
            });
            if (vspinTrue) {
                jQuery('.vertical-spin').prev('.bootstrap-touchspin-prefix').remove();
            }
            $("input[name='tch2']").TouchSpin({
                min: -1000000000,
                max: 1000000000,
                stepinterval: 50,
                maxboostedstep: 10000000,
                prefix: 's/.'
                });
      })(jQuery);
</script>
<div class="modal-dialog modal-lg">
    <div class="modal-content">
        <div class="modal-header">
            <h4 class="modal-title">Add Quotation New</h4>
        </div>
        <div id="print_doc" class="modal-body">
            <div class="row">
                <form id="form_quotation" class="form-horizontal">
                    {% csrf_token %}
                    <div class="row">
                        {% if not btn_edit %}
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="control-label col-md-3">{% trans 'Date' %}</label>
                                    <div class="col-md-9">
                                        <div class="input-group">
                                            {{ form_quotation.current_date }}
                                            <div class="input-group-addon"><i class="fa fa-calendar"></i></div>
                                        </div>
                                        <span class="help-block">{{ form_quotation.current_date.errors }}</span>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="control-label col-md-3">{% trans 'Vehicle' %}</label>
                                    <div class="col-md-9">
                                        {{ form_quotation.vehicle }}
                                        <span class="help-block">{{ form_quotation.vehicle.errors }}</span>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-12">
                                <div class="col-md-6 .col-md-offset-6">
                                    <div class="form-group">
                                        <label class="control-label col-md-3">{% trans 'Client' %}</label>
                                        <div class="col-md-9">
                                            {{ form_quotation.client }}
                                            <span class="help-block">{{ form_quotation.client.errors }}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="control-label col-md-3">{% trans 'Labour' %}</label>
                                    <div class="col-md-9">
                                        {{ form_quotation.labour }}
                                        <span class="help-block">{{ form_quotation.labour.errors }}</span>
                                        <input id="id_rate" type="hidden" value="1.00"/>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label class="control-label col-md-3">{% trans 'Price venta' %}</label>
                                    <div class="col-md-9">
                                        {{ form_quotation.sale_price }}
                                        <span class="help-block">{{ form_quotation.sale_price.errors }}</span>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-12">
                                <div class="col-md-2 col-md-offset-10">
                                    <button id="add_quotation_row" class="btn btn-info waves-effect waves-light" type="button">Add new</button>
                                </div>
                            </div>
                        {% else %}
                            <div class="col-md-12">
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label class="control-label col-md-3">{% trans 'Date' %}</label>
                                        <div class="col-md-9">
                                            <p class="form-control-static">{{ form_quotation.current_date }}</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label class="control-label col-md-3">{% trans 'Vehicle' %}</label>
                                        <div class="col-md-9">
                                            <p class="form-control-static">{{ form_quotation.vehicle }}</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label class="control-label col-md-3">{% trans 'Client' %}</label>
                                        <div class="col-md-9">
                                            <p class="form-control-static">{{ form_quotation.client.first_name }}</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        {% endif %}
                    </div>
                    <div class="col-md-12">
                       <div class="table-responsive m-t-20">
                          <table class="table table-hover">
                            <thead>
                              <tr>
                                <th class="text-center">Description</th>
                                <th class="text-center">Quantity</th>
                                <th class="text-center">Unit Price</th>
                                <th class="text-center">Total</th>
                                <th class="text-center"></th>
                              </tr>
                            </thead>

                            {% if not btn_edit %}
                                 <tbody id="tbody_quotation_row"></tbody>
                            {% else %}
                                <tbody>
                                    {% for detail in form_quotation_detail %}
                                        <tr>
                                            <td class="text-center">{{ detail.description }}</td>
                                            <td class="text-center">{{ detail.quantity }}</td>
                                            <td class="text-center">{{ detail.unit_price }}</td>
                                            <td class="text-center">{{ detail.amount_price }}</td>
                                            <td class="text-center"></td>
                                        </tr>
                                    {% endfor %}
                                </tbody>

                            {% endif %}

                          </table>
                       </div>
                    </div>
                    <div class="col-md-12">
                        <div class="col-md-12">
                            <div class="pull-right m-t-20 text-right">
                              {% if not btn_edit %}
                                  <p>Sub - Total amount: <span id="tr_row_sub_total"></span></p>
                                  <p>vat (18%) : <span id="tr_row_igv"></span></p>
                                  <hr>
                                  <h3><b>Total :</b> <span id="tr_row_total"></span></h3>
                              {% else %}
                                  <p>Sub - Total amount: {{ form_quotation.sub_total }}</p>
                                  <p>vat (18%) : {{ form_quotation.igv_tax }}</p>
                                  <hr>
                                  <h3><b>Total :</b> {{ form_quotation.total_paid }}</h3>
                              {% endif %}
                            </div>
                            <div class="clearfix"></div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-default waves-effect" data-dismiss="modal">{% trans "Cancel" %}</button>
             {% if not btn_edit %}
                <button type="button" id="save_quotation" class="btn btn-danger waves-effect waves-ligh">{% trans "Submit" %}</button>
            {% else %}
                 <button type="button" id="print_quotation" class="btn btn-danger waves-effect waves-ligh">{% trans "Printer" %}</button>
{#                <button type="button" id="update_quotation" class="btn btn-danger waves-effect waves-ligh">{% trans "Update" %}</button>#}
            {% endif %}
        </div>
    </div>
</div>